# Active Directory Pentesting Attacks


## 1. Samba Relay
If the firewall is desactivated you can locate vulnerable hosts with crackmapexec.

```sh
cme smb <network-range>
```
For this attack I'm will use responder.py that is preinstalled in kali under the path /usr/share/reponder.
This script is a network poisoner for a lot of protocols, that listens for comunications between machines in 
the domain and capture the NTLMv2 hash.

In this case if the samba certificate is not signed, it can't validate the commmunicators. So if a user requests a resource
that is offline or not exists in the network, the responder will pretend to be that resource and capture the NTLMv2 hash.

```sh
python3 Responder.py -I eth0 -rdw
```
Then, once you have the NTLMv2 hash, you could try to crack those hashes offline and if the password is weak you could retrive
those.

```sh
john --wordlist=/usr/share/wordlists/rockyou.txt hashes
``
